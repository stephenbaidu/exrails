window&&!window.InflectionJS&&(window.InflectionJS=null),InflectionJS={uncountable_words:["equipment","information","rice","money","species","series","fish","sheep","moose","deer","news","status","info"],plural_rules:[[new RegExp("(m)an$","gi"),"$1en"],[new RegExp("(pe)rson$","gi"),"$1ople"],[new RegExp("(child)$","gi"),"$1ren"],[new RegExp("^(ox)$","gi"),"$1en"],[new RegExp("(ax|test)is$","gi"),"$1es"],[new RegExp("(octop|vir)us$","gi"),"$1i"],[new RegExp("(alias|status)$","gi"),"$1es"],[new RegExp("(bu)s$","gi"),"$1ses"],[new RegExp("(buffal|tomat|potat)o$","gi"),"$1oes"],[new RegExp("([ti])um$","gi"),"$1a"],[new RegExp("sis$","gi"),"ses"],[new RegExp("(?:([^f])fe|([lr])f)$","gi"),"$1$2ves"],[new RegExp("(hive)$","gi"),"$1s"],[new RegExp("([^aeiouy]|qu)y$","gi"),"$1ies"],[new RegExp("(x|ch|ss|sh)$","gi"),"$1es"],[new RegExp("(matr|vert|ind)ix|ex$","gi"),"$1ices"],[new RegExp("([m|l])ouse$","gi"),"$1ice"],[new RegExp("(quiz)$","gi"),"$1zes"],[new RegExp("s$","gi"),"s"],[new RegExp("$","gi"),"s"]],singular_rules:[[new RegExp("(m)en$","gi"),"$1an"],[new RegExp("(pe)ople$","gi"),"$1rson"],[new RegExp("(child)ren$","gi"),"$1"],[new RegExp("([ti])a$","gi"),"$1um"],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),"$1$2sis"],[new RegExp("(hive)s$","gi"),"$1"],[new RegExp("(tive)s$","gi"),"$1"],[new RegExp("(curve)s$","gi"),"$1"],[new RegExp("([lr])ves$","gi"),"$1f"],[new RegExp("([^fo])ves$","gi"),"$1fe"],[new RegExp("([^aeiouy]|qu)ies$","gi"),"$1y"],[new RegExp("(s)eries$","gi"),"$1eries"],[new RegExp("(m)ovies$","gi"),"$1ovie"],[new RegExp("(x|ch|ss|sh)es$","gi"),"$1"],[new RegExp("([m|l])ice$","gi"),"$1ouse"],[new RegExp("(bus)es$","gi"),"$1"],[new RegExp("(o)es$","gi"),"$1"],[new RegExp("(shoe)s$","gi"),"$1"],[new RegExp("(cris|ax|test)es$","gi"),"$1is"],[new RegExp("(octop|vir)i$","gi"),"$1us"],[new RegExp("(alias|status)es$","gi"),"$1"],[new RegExp("^(ox)en","gi"),"$1"],[new RegExp("(vert|ind)ices$","gi"),"$1ex"],[new RegExp("(matr)ices$","gi"),"$1ix"],[new RegExp("(quiz)zes$","gi"),"$1"],[new RegExp("s$","gi"),""]],non_titlecased_words:["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],id_suffix:new RegExp("(_ids|_id)$","g"),underbar:new RegExp("_","g"),space_or_underbar:new RegExp("[ _]","g"),uppercase:new RegExp("([A-Z])","g"),underbar_prefix:new RegExp("^_"),apply_rules:function(a,b,c,d){if(d)a=d;else{var e=c.indexOf(a.toLowerCase())>-1;if(!e)for(var f=0;f<b.length;f++)if(a.match(b[f][0])){a=a.replace(b[f][0],b[f][1]);break}}return a}},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b,c){b||(b=-1);for(var d=-1,e=b;e<this.length;e++)if(this[e]===a||c&&c(this[e],a)){d=e;break}return d}),String.prototype._uncountable_words||(String.prototype._uncountable_words=InflectionJS.uncountable_words),String.prototype._plural_rules||(String.prototype._plural_rules=InflectionJS.plural_rules),String.prototype._singular_rules||(String.prototype._singular_rules=InflectionJS.singular_rules),String.prototype._non_titlecased_words||(String.prototype._non_titlecased_words=InflectionJS.non_titlecased_words),String.prototype.pluralize||(String.prototype.pluralize=function(a){return InflectionJS.apply_rules(this.toString(),this._plural_rules,this._uncountable_words,a)}),String.prototype.singularize||(String.prototype.singularize=function(a){return InflectionJS.apply_rules(this.toString(),this._singular_rules,this._uncountable_words,a)}),String.prototype.camelize||(String.prototype.camelize=function(a){for(var b=this.toLowerCase(),c=b.split("/"),d=0;d<c.length;d++){for(var e=c[d].split("_"),f=a&&d+1===c.length?1:0,g=f;g<e.length;g++)e[g]=e[g].charAt(0).toUpperCase()+e[g].substring(1);c[d]=e.join("")}return b=c.join("::")}),String.prototype.underscore||(String.prototype.underscore=function(){for(var a=this,b=a.split("::"),c=0;c<b.length;c++)b[c]=b[c].replace(InflectionJS.uppercase,"_$1"),b[c]=b[c].replace(InflectionJS.underbar_prefix,"");return a=b.join("/").toLowerCase()}),String.prototype.humanize||(String.prototype.humanize=function(a){var b=this.toLowerCase();return b=b.replace(InflectionJS.id_suffix,""),b=b.replace(InflectionJS.underbar," "),a||(b=b.capitalize()),b}),String.prototype.capitalize||(String.prototype.capitalize=function(){var a=this.toLowerCase();return a=a.substring(0,1).toUpperCase()+a.substring(1)}),String.prototype.dasherize||(String.prototype.dasherize=function(){var a=this;return a=a.replace(InflectionJS.space_or_underbar,"-")}),String.prototype.titleize||(String.prototype.titleize=function(){var a=this.toLowerCase();a=a.replace(InflectionJS.underbar," ");for(var b=a.split(" "),c=0;c<b.length;c++){for(var d=b[c].split("-"),e=0;e<d.length;e++)this._non_titlecased_words.indexOf(d[e].toLowerCase())<0&&(d[e]=d[e].capitalize());b[c]=d.join("-")}return a=b.join(" "),a=a.substring(0,1).toUpperCase()+a.substring(1)}),String.prototype.demodulize||(String.prototype.demodulize=function(){var a=this,b=a.split("::");return a=b[b.length-1]}),String.prototype.tableize||(String.prototype.tableize=function(){var a=this;return a=a.underscore().pluralize()}),String.prototype.classify||(String.prototype.classify=function(){var a=this;return a=a.camelize().singularize()}),String.prototype.foreign_key||(String.prototype.foreign_key=function(a){var b=this;return b=b.demodulize().underscore()+(a?"":"_")+"id"}),String.prototype.ordinalize||(String.prototype.ordinalize=function(){for(var a=this,b=a.split(" "),c=0;c<b.length;c++){var d=parseInt(b[c]);if(0/0===d){var e=b[c].substring(b[c].length-2),f=b[c].substring(b[c].length-1),g="th";"11"!=e&&"12"!=e&&"13"!=e&&("1"===f?g="st":"2"===f?g="nd":"3"===f&&(g="rd")),b[c]+=g}}return a=b.join(" ")});var app=angular.module("angularApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ui.router","ngSanitize","ngTouch","ng-token-auth","angular-underscore","ui.bootstrap","ui.select","pascalprecht.translate","schemaForm"]);app.constant("APP",{root:"/",tplPrefix:"/tpl/",apiPrefix:"/api/",modules:{main:{text:"Main Menu",url:"app",icon:"fa fa-home fa-lg",links:[{text:"Samples",url:"samples",icon:"glyphicon glyphicon-user"}]},reports:{text:"Reports",url:"reports",icon:"glyphicon glyphicon-stats",links:[{text:"Samples",url:"samples",icon:"fa fa-clipboard"}]},setups:{text:"Setups",url:"setups",icon:"fa fa-cogs fa-lg",links:[{text:"Users",url:"users",icon:"fa fa-user"},{text:"Sample Status",url:"sample-statuses",icon:"fa fa-tags"}]}}}),app.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),b.when("/app","/app/dashboard"),b.when("/app/main","/app/main/samples"),b.when("/app/reports","/app/reports/samples"),b.when("/app/setups","/app/setups/sample-statuses"),a.state("login",{url:"/",templateUrl:"views/layouts/login.html",controller:"MainCtrl"}).state("app",{url:"/app","abstract":!0,templateUrl:"views/layouts/app.html",controller:"AppCtrl",resolve:{auth:["$auth","$state","$rootScope",function(a,b,c){return a.validateUser().then(function(a){c.currentUser=a})["catch"](function(){b.go("login")})}]}}).state("app.dashboard",{url:"/dashboard",templateUrl:function(){return"views/layouts/dashboard.html"},controller:"ModuleCtrl"}).state("app.module",{url:"/:module",templateUrl:function(a){return"views/layouts/"+a.module+"_module.html"},controller:"ModuleCtrl"}).state("app.module.model",{url:"/:model",templateUrl:function(a){return"views/app/"+a.model+"/index.html"},controller:"IndexCtrl"}).state("app.module.model.index",{url:"/index",templateUrl:function(a){return"views/app/"+a.model+"/index.html"},controller:"IndexCtrl"}).state("app.module.model.new",{url:"/new",templateUrl:function(a){return"views/app/"+a.model+"/new.html"},controller:"FormCtrl"}).state("app.module.model.view",{url:"/:view",templateUrl:function(a){return"views/app/"+a.model+"/"+a.view+"/.html"},controller:"FormCtrl"}).state("app.module.model.show",{url:"/:id/show",templateUrl:function(a){return"views/app/"+a.model+"/show.html"},controller:"FormCtrl"}).state("app.module.model.edit",{url:"/:id/edit",templateUrl:function(a){return"views/app/"+a.model+"/edit.html"},controller:"FormCtrl"})}]).config(["$authProvider",function(a){a.configure({apiUrl:"/api"})}]).factory("$exceptionHandler",function(){return function(){}}),angular.module("angularApp").controller("MainCtrl",["$rootScope","$scope","$auth","$state","exMsgBox","$modal","APP",function(a,b,c,d,e,f){var g,h,i,j;a.showErrors=function(a){a&&angular.forEach(a,function(a){e.error(a)})},a.sendPasswordResetEmail=function(){new PNotify({title:"Request Password Reset",text:"Email",icon:"glyphicon glyphicon-question-sign",hide:!1,confirm:{prompt:!0},buttons:{closer:!1,sticker:!1},history:{history:!1},before_open:function(a){a.get().css({top:"20px",left:$(window).width()/2-a.get().width()/2})}}).get().on("pnotify.confirm",function(a,b,d){var f=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;f.test(d)?(console.log("Valid"),c.requestPasswordReset({email:d})):(b.remove(),e.notify({title:"Invalid email",text:"You provided an invalid email",type:"error"}))}).on("pnotify.cancel",function(a,b){b.remove()})},b.$on("auth:registration-email-success",function(a,b){e.info("A registration email was sent to "+b.email+". Follow the instructions contained in the email to complete registration.")}),b.$on("auth:registration-email-error",function(a,b){console.log(b),angular.forEach(b.errors.full_messages,function(a){e.error(a)})}),b.$on("auth:password-reset-request-success",function(a,b){e.info("An email has been sent to "+b.email+" containing instructions for resetting your password.")}),b.$on("auth:password-reset-request-error",function(a,b){e.error(_.map(b.errors).toString())}),i=function(){f.open({title:"Change your password!",html:!0,show:!1,templateUrl:"views/partials/password-reset-modal.html"})},j=function(){f.open({title:"Success",html:!0,show:!1,template:"<div id='alert-password-change-success'>Your password has been successfully updated."})},h=b.$new(),g=function(){f.open({title:"Error",html:!0,show:!1,scope:h,templateUrl:"views/partials/password-change-error-modal.html"})},b.showPasswordChangeModal=function(){i()},b.$on("auth:password-reset-confirm-success",function(){i()}),b.$on("auth:password-change-success",function(){return i.hide(),j.show()}),b.$on("auth:password-change-error",function(a,b){h.errors=b.errors,i.hide(),g()}),h.$on("modal.hide",function(){i()}),b.$on("auth:login-success",function(){d.go("app.dashboard")}),b.$on("auth:login-error",function(a,b){e.error("Authentication failure: "+b.errors[0])}),b.$on("auth:account-update-success",function(){e.info("Your account has been updated.")}),b.$on("auth:account-destroy-success",function(){e.error("Your account has been destroyed.")}),b.signup=function(){c.submitRegistration(b.signupData).then(function(){})["catch"](function(a){b.showErrors(a.data.errors.full_messages)})},b.test=function(){}}]),angular.module("angularApp").controller("AppCtrl",["$scope","$rootScope","$http","$auth","$q","$modal","$state","APP","exMsgBox",function(a,b,c,d,e,f,g,h,i){b.modules=h.modules||{},b.state={isIndex:!0,isNew:!1,isShow:!1,isEdit:!1,update:function(a){a&&(this.isIndex="app.module.model"==a.name,this.isNew="app.module.model.new"==a.name,this.isShow="app.module.model.show"==a.name,this.isEdit="app.module.model.edit"==a.name)}},b.hasAccess=function(a){if(d.user.is_admin)return!0;var b=a||"";if(b=b.replace(/-/gi,"_"),b.indexOf(":")<0)if(b=b.split("?")[0],b.indexOf("/")<0)b=b.classify()+":index";else{var c=/^([A-z-_]+)\/new/gi,e=/^([A-z-_]+)\/(\d+)\/show/gi,f=/^([A-z-_]+)\/(\d+)\/edit/gi,g=c.exec(b),h=e.exec(b),i=f.exec(b);g?b=g[1].classify()+":create":h?b=h[1].classify()+":show":i&&(b=i[1].classify()+":update")}var j=_.find(d.user.permissions,function(a){return a===b});return void 0===j?!1:!0},b.back=function(){g.go("^")},b.state.update(b.state.update(g.current)),b.$on("$stateChangeSuccess",function(a,c){b.state.update(c)}),b.hasUrl=function(a){return window.location.hash.indexOf(a)>=0},b.buildQ=function(a){return _.map(a,function(a,b){return b+".eq."+a}).join(":")},b.splitQ=function(a){var b={};return a.split(":").forEach(function(a){var c=a.split(".eq.");c[1]&&(b[c[0]]=c[1])}),b},c.post(h.apiPrefix+"users/"+d.user.id+"/permissions").success(function(a){d.user.permissions=a}),c.get(h.apiPrefix+"users/"+d.user.id).success(function(a){d.user.client=a.client,d.user.branch=a.branch,d.user.is_admin=a.is_admin,d.user.is_system_admin=a.is_system_admin}),a.$on("auth:logout-success",function(){g.go("login")}),a.$on("auth:logout-error",function(){i.error("Unable to complete logout. Please try again.")}),b.showPasswordReset=function(){sweetAlert({title:"Change Password",text:"Current Password:",type:"input",inputType:"password",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"Current Password"},function(a){return a===!1?!1:""===a?(sweetAlert.showInput("No password provided!"),!1):void sweetAlert({title:"Change Password",text:"New Password:",type:"input",inputType:"password",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"New Password"},function(b){return b===!1?!1:""===b?(sweetAlert.showInput("No password provided!"),!1):void sweetAlert({title:"Change Password",text:"New Password Again:",type:"input",inputType:"password",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"New Password Again"},function(e){return e===!1?!1:""===e?(sweetAlert.showInput("No password provided!"),!1):void c.post(h.apiPrefix+"users/"+d.user.id+"/change_password",{current_password:a,password:b,password_confirmation:e}).success(function(a){a.error?sweetAlert(a.message,(a.messages||[]).join("\n"),"error"):sweetAlert("Great!","Password changed successfully","success")})["catch"](function(){sweetAlert("Nice!","You wrote: "+inputValue,"error")})["finally"](function(){})})})})}}]),angular.module("angularApp").controller("ModuleCtrl",["$scope","APP",function(a){window.AppModuleCtrl=a}]),angular.module("angularApp").controller("IndexCtrl",["$scope","$rootScope","$state","$stateParams","$q","$http","APP","resourceManager","$filter","exMsgBox","byValueFilter",function(a,b,c,d,e,f,g,h,i,j,k){window.AppIndexCtrl=a,window.msgBox=j,a.grid={},a.recordsHash={},a.records=[],a.searchQuery=null,a.action={loading:!1,deleting:!1},a.paging={totalRecords:0,recordsPerPage:15,currentPage:1,previousId:0,currentId:0,nextId:0},a.model=h.register(d.model,g.apiPrefix+d.model.replace(/-/gi,"_")+"/:id"),a.queryRecords=function(c,d,e){a.action.loading=!0,e||(e=a.searchQuery||{}),e.page=c||a.paging.currentPage,e.size=d||a.paging.recordsPerPage,h.query(a.model.name,e,function(b,c){a.paging.totalRecords=c}).then(function(c){a.updateRecords(c),b.$broadcast("model:records-loaded",a)})["catch"](function(b){console.log(b),a.error(b)})["finally"](function(){a.action.loading=!1})},a.hasCreateAccess=function(){return b.hasAccess(a.model.name+":create")},a.hasShowAccess=function(){return b.hasAccess(a.model.name+":show")},a.hasUpdateAccess=function(){return b.hasAccess(a.model.name+":update")},a.hasDeleteAccess=function(){return b.hasAccess(a.model.name+":delete")},a.$on("model:records-loaded",function(b,c){c.model.name==a.model.name&&a.updatePreviousNext()}),a.$on("model:record-loaded",function(b,c){c.model.name==a.model.name&&(a.paging.currentId=c.record.id,a.updatePreviousNext())}),a.updatePreviousNext=function(){if(0!=a.records.length&&0!=a.paging.currentId){var b=i("previousNextIds")(a.records,a.paging.currentId);b&&(a.paging.previousId=b.previousId,a.paging.nextId=b.nextId)}},a.fieldData=function(b,c){var d=a.schema.properties[c],e=d&&d.lookup||!1,f=b[c];return e?k(a.lookups[e],f).name:f},a.updateRecords=function(b){angular.forEach(b,function(b){a.recordsHash[b.id]||(a.records.push(b),a.recordsHash[b.id]=!0)})},a.updateRecordInRecords=function(b){b&&angular.forEach(a.records,function(c,d){return c.id==b.id?void(a.records[d]=b):void 0})},a.reload=function(){a.recordsHash={},a.records=[],a.paging.currentPage=1,a.queryRecords()},a.loadMore=function(){a.records.length<a.paging.totalRecords&&(a.paging.currentPage=a.paging.currentPage+1,a.queryRecords())},a.setSearchQuery=function(b){a.searchQuery=b},a.$watch("paging.recordsPerPage",function(){a.queryRecords()}),a.error=function(a){a=a||{},a.message&&j.error(a.message,a.type||"Error"),a.messages&&b.errorSummary(a.messages)},a["delete"]=function(b){a.action.deleting=!0;var c="Are you sure you want to delete this "+a.schema.title+"?";j.confirm(c,"Confirm Delete").then(function(){var c={id:b};c[a.model.key]=a.record,h["delete"](a.model.name,c).then(function(){a.reload(),j.success(a.schema.title+" deleted successfully")})["catch"](function(b){a.error(b)})["finally"](function(){a.action.deleting=!1})})["catch"](function(){a.action.deleting=!1})},a.loadConfig=function(){f.get(g.apiPrefix+"config/"+a.model.url).success(function(c){a.lookups=c.lookups,a.schema=c.schema,a.grid=c.grid,b.$broadcast("model:config-loaded",a)}).error(function(){j.error("error")})},a.loadConfig()}]),angular.module("angularApp").controller("FormCtrl",["$scope","$rootScope","APP","resourceManager","exMsgBox","$state","$stateParams","$http","$translate",function(a,b,c,d,e,f,g,h){window.AppFormCtrl=a,a.lookups={},a.schema={},a.form={},a.record={},a.action={loading:!0,saving:!1,creating:!1,updating:!1,deleting:!1},a.loadConfig=function(){h.get(c.apiPrefix+"config/"+a.model.url).success(function(c){a.lookups=c.lookups,a.schema=c.schema,a.form=c.form,a.setDisableFields(),b.$broadcast("model:config-loaded",a),a.setRecord()}).error(function(){e.error("error")})},a.setDisableFields=function(){"app.module.model.show"===f.$current.name&&angular.forEach(a.schema.properties,function(a){a.readonly=!0})},a.loadRecord=function(){if(a.action.loading=!0,g.id){var c={id:g.id};d.get(a.model.name,c).then(function(c){a.record=c,a.sanitizeRecord(),b.$broadcast("model:record-loaded",a),a.action.loading=!1,a.$broadcast("schemaFormRedraw")})["catch"](function(b){a.error(b),a.action.loading=!1})}else b.$broadcast("model:record-new",a)},a.sanitizeRecord=function(){_.each(a.record,function(b,c){null===b&&(a.record[c]="")})},a.setRecord=function(){!a.record.id&&g.q&&(_.each(a.splitQ(g.q),function(b,c){a.record[c]=b}),b.$broadcast("model:record-set",a))},a.close=function(){a.record={},f.go("^")},a.redirectBack=function(){a.record={},f.go("^"),a.queryRecords()},a.create=function(){a.action.saving=!0,a.action.creating=!0;var c={};c[a.model.key]=a.record,d.create(a.model.name,c).then(function(c){b.$broadcast("model:record-created",a),e.success(a.schema.title+" created successfully"),a.record.id=c.id,a.redirectBack()})["catch"](function(b){a.error(b)})["finally"](function(){a.action.saving=!1,a.action.creating=!1})},a.edit=function(){f.go("^.edit",{id:g.id})},a.update=function(){a.action.saving=!0,a.action.updating=!0;var c={id:g.id};c[a.model.key]=a.record,d.update(a.model.name,c).then(function(c){b.$broadcast("model:record-updated",a),e.success(a.schema.title+" updated successfully"),a.updateRecordInRecords(c),a.redirectBack()})["catch"](function(b){a.error(b)})["finally"](function(){a.action.saving=!1,a.action.updating=!1})},a.save=function(){PNotify.removeAll(),a.$broadcast("schemaFormValidate"),(!a.formObject||a.formObject.$valid)&&(g.id?a.update():a.create())},a["delete"]=function(){a.action.deleting=!0;var b="Are you sure you want to delete this "+a.schema.title+"?";e.confirm(b,"Confirm Delete").then(function(){var b={id:a.record.id};b[a.model.key]=a.record,d["delete"](a.model.name,b).then(function(){e.success(a.schema.title+" deleted successfully"),a.reload(),a.redirectBack()})["catch"](function(b){a.error(b)})["finally"](function(){a.action.deleting=!1})})["catch"](function(){a.action.deleting=!1})},a.loadConfig(),a.loadRecord()}]),angular.module("angularApp").filter("byId",function(){return function(a,b){for(var c=0,d=a.length;d>c;c++)if(+a[c].id==+b)return a[c];return{}}}),angular.module("angularApp").filter("byValue",function(){return function(a,b){for(var c=0,d=a.length;d>c;c++)if(+a[c].value==+b)return a[c];return{}}}),angular.module("angularApp").filter("previousNextIds",function(){return function(a,b){for(var c={previousId:0,nextId:0},d=0,e=a.length;e>d;d++)if(+a[d].id==+b)return d>0&&(c.previousId=a[d-1].id),e-1>d&&(c.nextId=a[d+1].id),c;return c}}),angular.module("angularApp").directive("exEditableGrid",["$compile","$sce",function(a,b){var c=function(c,d,e){function f(a){var b="",c="";return a.lookup?(c='<select ui-select2="{}" class="form-control input-sm select2" ng-model="item.<%= name %>"><option ng-repeat="l in lookup_<%= lookup %>" value="{{ l.id }}"> {{ l.name }} </option></select>',b=_.template(c,{name:a.name,lookup:a.lookup})):(c='<input type="text" class="form-control input-sm" ng-model="item.<%= name %>"/>',b=_.template(c,{name:a.name})),b}function g(a){var b={date:" | date",time:" | date:'shortTime'",datetime:" | date:'medium'",money:" | number:'2'",decimal3:" | number:'3'",decimal4:" | number:'4'"};return b[a.type]||""}function h(){var a="";return a+='<a href="" ng-show="editorEnabled($index)" ng-click="saveEdit()"><i class="glyphicon glyphicon-ok"></i></a>&nbsp;&nbsp;',a+='<a href="" ng-show="editorEnabled($index)" ng-click="cancelEdit()"><i class="glyphicon glyphicon-remove"></i></a>',a+='<a href="" ng-hide="editorEnabled($index)" ng-click="startEdit($index)"><i class="glyphicon glyphicon-pencil"></i></a>&nbsp;',c.typeFixed||(a+='<a href="" ng-hide="editorEnabled($index)" ng-click="removeItem($index)"><i class="glyphicon glyphicon-trash"></i></a>'),a}function i(){var b='<div class="cls-ex-editable-grid">',i="<th class='grid-action-1'>#</th>",j="<td>{{ $index + 1 }}.</td>";c.typeFixed||(b+='<div ng-show="editorIndex == -1" class="pull-right" style="margin-top: -3px;">',b+='  <a href="" ng-click="newItem()" class="btn btn-primary btn-xs" ng-hide="viewOnly">',b+='    <span class="glyphicon glyphicon-plus"></span> New',b+="  </a>",b+="</div>"),b+="<label><u>"+(e.title||"&nbsp;")+"</u></label>",angular.forEach(c.columns,function(a){i+="<th "+a.attrs+">"+a.header+"</th>",a.fixed?j+="<td "+a.attrs+">{{ item."+a.name+g(a)+" }}</td>":"html"==a.type?j+="<td "+a.attrs+' ng-bind-html="bindHtml(item.'+a.name+')"></td>':(j+=a.lookup?"<td "+a.attrs+' ng-hide="editorEnabled($index)">{{ (lookup_'+a.lookup+" | byValue:item."+a.name+").name"+g(a)+" }}</td>":"<td "+a.attrs+' ng-hide="editorEnabled($index)">{{ item.'+a.name+g(a)+" }}</td>",j+='<td ng-show="editorEnabled($index)">'+(a.html||f(a))+"</td>")}),i+='<th class="grid-action-2" ng-hide="viewOnly"></th>',j+='<td ng-hide="viewOnly">'+h()+"</td>",b+='<table style="font-size: 12px;">',b+="  <thead>",b+=i,b+="  </thead>",b+="  <tbody>",b+='    <tr ng-repeat="item in ngModel">',b+=j,b+="    </tr>",b+="  </tbody>",b+="</table></div>",d.html(b),d.attr("class",""),angular.element(d).find("table").attr("class",e["class"]||"table table-condensed table-striped table-hover"),a(d.contents())(c)}c.ngModel=c.ngModel||[],c.columns=c.columns||[],c.title=e.title||"",c.viewOnly=!!c.viewOnly,c.typeFixed=!!c.typeFixed,c.bindHtml=function(a){return b.trustAsHtml(a)},c.$watch("ngModel",function(){i()}),c.$watch("columns",function(){i()}),c.$watch("viewOnly",function(){i()}),c.$watch("typeFixed",function(){i()})},d=["$scope","$element","exMsgBox","$filter","$sce",function(a,b,c){function d(){1==_.size(a.ngModel[a.editorIndex])&&a.ngModel.splice(a.editorIndex,1)}a.editorIndex=-1,a.isNewItem=!1,a.$watch("lookups",function(){angular.forEach(a.lookups,function(b,c){a["lookup_"+c]=b})},!0),a.startEdit=function(b){a.prevRowData=angular.copy(a.ngModel[b]),a.editorIndex=b,a.isNewItem=!1},a.editorEnabled=function(b){return a.editorIndex==b},a.removeItem=function(b){var d="Are you sure you want to remove this item?";c.confirm(d,a.title||"Confirm Delete").then(function(){a.onDelete&&a.onDelete(angular.copy(a.ngModel[b])),a.ngModel.splice(b,1)})},a.newItem=function(){a.ngModel=a.ngModel||[],a.ngModel.push({}),a.editorIndex=a.ngModel.length-1,a.isNewItem=!0},a.saveEdit=function(){d(),a.onCreate&&a.isNewItem?a.onCreate(angular.copy(a.ngModel[a.editorIndex])):a.onUpdate&&!a.isNewItem&&a.onUpdate(angular.copy(a.ngModel[a.editorIndex])),a.editorIndex=-1},a.cancelEdit=function(){angular.extend(a.ngModel[a.editorIndex],a.prevRowData),d(),a.editorIndex=-1}}];return{restrict:"E",scope:{columns:"=",ngModel:"=",lookups:"=",viewOnly:"@",typeFixed:"@",onCreate:"=",onUpdate:"=",onDelete:"="},replace:!0,link:c,controller:d}}]),angular.module("angularApp").service("exMsgBox",["$q",function(a){return{notify:function(a){new PNotify(a)},success:function(a,b){new PNotify({title:b||"Success",text:a,type:"success",nonblock:!0,nonblock_opacity:.2})},error:function(a,b){new PNotify({title:b||"Error",text:a,type:"error",nonblock:!0,nonblock_opacity:.2})},notice:function(a){new PNotify({text:a,type:"notice",nonblock:!0,nonblock_opacity:.5})},info:function(a,b){new PNotify({title:b||"Info",text:a,addclass:"custom",opacity:.8,nonblock:!0,nonblock_opacity:.2})},errorSummary:function(a){var b="<ul>";angular.forEach(a,function(a){b+="<li>"+a+"</li>"}),b+="</ul>",new PNotify({title:"Error Summary",text:b,type:"error",hide:!1})},confirm:function(b,c){var d=a.defer();return new PNotify({title:c||"Confirmation Needed",text:b,icon:"glyphicon glyphicon-question-sign",hide:!1,confirm:{confirm:!0},buttons:{closer:!1,sticker:!1},history:{history:!1}}).get().on("pnotify.confirm",function(){d.resolve(!0)}).on("pnotify.cancel",function(){d.reject(!1)}),d.promise},clear:function(){PNotify.removeAll()},sweetAlert:function(a){sweetAlert(a)},prompt:function(b,c){var d=a.defer();return sweetAlert({title:c||"Input Needed",text:b,type:"input",showCancelButton:!0,animation:"slide-from-top"},function(a){return a===!1?(d.reject(!1),!1):(d.resolve(a),!0)}),d.promise}}}]),angular.module("angularApp").service("resourceManager",["$q","$http","$resource",function(a,b,c){var d={models:{}};return d.getName=function(a){return a=a.replace(/-/gi,"_"),a=a.underscore().split("_"),a=a.slice(0,a.length-1).join("_").camelize()+a[a.length-1].classify()},d.getUrl=function(a){return a=a.underscore().split("_"),a=a.slice(0,a.length-1).join("_").camelize()+a[a.length-1].pluralize().camelize(),a.underscore()},d.getModel=function(a,b){return b=b||{},b.name=a=this.getName(a),b.url||(b.url=this.getUrl(a)),b.key||(b.key=a.underscore()),b.title||(b.title=b.url.titleize()),b},d.register=function(a,b,d,e){if(a=this.getName(a),d=d||{id:"@id"},e=e||{},!this.models[a]){var f=c(b,d,{query:{method:"GET",isArray:!0},update:{method:"PUT"}});app.factory(a,function(){return f}),this.models[a]=this.getModel(a,e),this.models[a].apiUrl=b,this.models[a].klass=f}return this.models[a]},d.query=function(b,c,d){var e=a.defer();return b=this.getName(b),this.models[b].klass.query(c,function(a,b){a.error||a.errors?e.reject(a):e.resolve(a),d&&d(a,b("_meta_total"))},function(a){e.reject(a)}).$promise["catch"](function(a){window.error=a,e.reject({message:"Sorry, you do not have permission."})}),e.promise},d.get=function(b,c,d){var e=a.defer();return b=this.getName(b),this.models[b].klass.get(c,function(a){a.error?e.reject(a):e.resolve(a),d&&d(a)},function(a){console.log(a)}),e.promise},d.create=function(b,c,d){var e=a.defer();return b=this.getName(b),new this.models[b].klass(c).$save(function(a){a.error?e.reject(a):e.resolve(a),d&&d(a)},function(a){console.log(a)}),e.promise},d.update=function(b,c,d){var e=a.defer();return b=this.getName(b),new this.models[b].klass(c).$update(function(a){a.error?e.reject(a):e.resolve(a),d&&d(a)},function(a){console.log(a)}),e.promise},d["delete"]=function(b,c,d){var e=a.defer();return b=this.getName(b),new this.models[b].klass(c).$delete(function(a){a.error?e.reject(a):e.resolve(a),d&&d(a)},function(a){console.log(a)}),e.promise},d}]),angular.module("angularApp").controller("UserCtrl",["$scope","$rootScope","APP","exMsgBox","$http","$state","$stateParams",function(a,b,c,d,e,f,g){function h(a){var b=["sign_in_count","current_sign_in_at","last_sign_in_at","current_sign_in_ip","last_sign_in_ip","failed_attempts","name","image","email","role_ids","status"];angular.forEach(a.schema.properties,function(c,d){b.indexOf(d)<0&&delete a.schema.properties[d]}),a.form=[{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"name",fieldHtmlClass:"input-lg"}]},{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"email",fieldHtmlClass:"input-lg"}]}]},{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"sign_in_count",fieldHtmlClass:"input-lg"}]},{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"failed_attempts",fieldHtmlClass:"input-lg"}]}]},{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"current_sign_in_at",fieldHtmlClass:"input-lg",pickadate:{selectYears:!0,selectMonths:!0}}]},{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"last_sign_in_at",fieldHtmlClass:"input-lg",pickadate:{selectYears:!0,selectMonths:!0}}]}]},{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"current_sign_in_ip",fieldHtmlClass:"input-lg"}]},{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"last_sign_in_ip",fieldHtmlClass:"input-lg"}]}]},{type:"section",htmlClass:"row large-tags-",items:[{type:"section",htmlClass:"col-xs-6",items:[{key:"role_ids",fieldHtmlClass:"input-lg"}]},{type:"section",htmlClass:"col-xs-6",items:[{key:"status",fieldHtmlClass:"input-lg"}]}]}]}function i(a){a.schema.properties.password={title:"Password",type:"string"},a.schema.properties.password_confirmation={title:"Confirm Password",type:"string"},a.schema.properties.enforce_confirmation={title:"Enforce Email Confirmation",type:"boolean","default":!1},a.form=[{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"name",fieldHtmlClass:"input-lg"}]},{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"email",fieldHtmlClass:"input-lg"}]}]},{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"password",type:"password",fieldHtmlClass:"input-lg"}]},{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"password_confirmation",type:"password",fieldHtmlClass:"input-lg"}]}]},{type:"section",htmlClass:"row large-tags",items:[{type:"section",htmlClass:"col-xs-12",items:[{key:"role_ids",fieldHtmlClass:"input-lg"}]}]},{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-sm-6 col-xs-12",items:[{key:"enforce_confirmation",fieldHtmlClass:"input-lg"}]}]},{type:"conditional",condition:"record.enforce_confirmation",items:[{type:"help",helpvalue:'<div class="alert alert-info">A confirmation email will be sent to the User to confirm this account</div>'}]}]}window.AppUserCtrl=a,a.stateParams=g,a.state=f,a.$on("model:config-loaded",function(a,c){c.model&&"User"===c.model.name&&(c.grid=["name","email","current_sign_in_at","current_sign_in_ip","last_sign_in_at","last_sign_in_ip"],c.schema.required=["name","email"],c.schema.properties.status={title:"Status",type:"string",readonly:!0},"app.module.model.new"===f.$current.name?(i(c),b.$broadcast("ui:form-updated",c)):h(c))}),a.$on("model:record-loaded",function(a,b){"User"===b.model.name&&(b.lockUser=function(){b.action.locking=!0,e.post(c.apiPrefix+"users/"+b.record.id+"/lock").success(function(a){b.record=a,d.success("User successfully locked")})["catch"](function(a){d.error(a.message)})["finally"](function(){b.action.locking=!1})},b.unlockUser=function(){b.action.unlocking=!0,e.post(c.apiPrefix+"users/"+b.record.id+"/unlock").success(function(a){b.record=a,d.success("User successfully unlocked")})["catch"](function(a){d.error(a.message)})["finally"](function(){b.action.unlocking=!1})},b.resetPassword=function(){})
})}]),angular.module("angularApp").controller("UiCtrl",["$scope","APP","$http","$state","$stateParams",function(a){window.AppUiCtrl=a,a.$on("model:config-loaded",function(a,b){b.model&&b.schema&&"User"===b.model.name}),a.$on("ui:form-updated",function(b,c){"User"===c.model.name&&a.user.is_admin})}]);